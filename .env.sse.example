# Service Desk Plus MCP Server - SSE-Only Configuration
# This is the production-ready configuration for SSE-only deployment

# === REQUIRED: Service Desk Plus API Configuration ===
SDP_CLIENT_ID=your_client_id_here
SDP_CLIENT_SECRET=your_client_secret_here
SDP_INSTANCE_NAME=your-instance
SDP_BASE_URL=https://your-portal-domain.com

# OAuth Refresh Token (obtained via Self Client setup)
SDP_REFRESH_TOKEN=your_refresh_token_here

# === TECHNICIAN CONTEXT ===
# Default technician email for operations (e.g., closing tickets, assignments)
# This email will be used when performing actions that require a technician context
SDP_DEFAULT_TECHNICIAN_EMAIL=technician@example.com

# === REQUIRED: SSE Server Configuration ===
# Server binding
SDP_HTTP_PORT=3456
SDP_HTTP_HOST=127.0.0.1  # Use 0.0.0.0 for external access

# API Keys (comma-separated, use strong random keys)
SDP_API_KEYS=your-secure-api-key-32-chars-minimum

# === Security Configuration ===
# IP Allowlist (* for all, or comma-separated IPs/CIDR ranges)
SDP_ALLOWED_IPS=*  # Example: 192.168.1.0/24,10.0.0.0/8,172.16.0.1

# CORS Settings
SDP_ENABLE_CORS=true
SDP_CORS_ORIGIN=*  # Production: https://yourdomain.com,https://app.yourdomain.com

# Connection Limits
SDP_MAX_CONNECTIONS=100  # Maximum concurrent SSE connections
SDP_SESSION_TIMEOUT=1800000  # Session timeout in ms (30 minutes)
SDP_RATE_LIMIT_PER_KEY=60  # Requests per minute per API key

# === Database Configuration (Recommended) ===
SDP_USE_DB_TOKENS=true  # Enable persistent token storage
SDP_USE_AUDIT_LOG=true  # Enable API audit logging
SDP_USE_CHANGE_TRACKING=true  # Track changes for rollback

SDP_DB_HOST=localhost
SDP_DB_PORT=5433
SDP_DB_NAME=sdp_mcp
SDP_DB_USER=sdpmcpservice
SDP_DB_PASSWORD=your_secure_password_here
SDP_DB_SSL=false  # Set to true for production

# === Features & Monitoring ===
SDP_ENABLE_MONITORING=true  # Enable rate limit monitoring
SDP_ENABLE_ANALYTICS=false  # Enable usage analytics
SDP_ENABLE_QUEUE=false  # Enable request queuing
SDP_ENABLE_COORDINATION=false  # Enable multi-instance coordination
SDP_ENABLE_METRICS=true  # Enable /metrics endpoint

# === Server Identity ===
MCP_SERVER_NAME=service-desk-plus-sse

# === Rate Limiting (Core Settings) ===
# These are enforced across all API operations
SDP_RATE_LIMIT_PER_MINUTE=60  # API requests per minute

# === Production Recommendations ===
# 1. Generate strong API keys: openssl rand -hex 32
# 2. Use specific IP ranges instead of *
# 3. Configure specific CORS origins
# 4. Enable database for token persistence
# 5. Use HTTPS with reverse proxy (nginx/apache)
# 6. Monitor /health and /metrics endpoints
# 7. Set up log aggregation for production
# 8. Configure alerts for high error rates

# === HTTPS/TLS (Use reverse proxy) ===
# Example Nginx configuration:
# server {
#     listen 443 ssl http2;
#     server_name sdp-mcp.yourdomain.com;
#     
#     ssl_certificate /path/to/cert.pem;
#     ssl_certificate_key /path/to/key.pem;
#     
#     location / {
#         proxy_pass http://127.0.0.1:3456;
#         proxy_http_version 1.1;
#         proxy_set_header Upgrade $http_upgrade;
#         proxy_set_header Connection '';
#         proxy_buffering off;
#         proxy_cache off;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto $scheme;
#     }
# }